<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Depósito - Funcionário | SLA Sistema de Logística e Armazenamento</title>
    <link rel="stylesheet" href="../style/deposit.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
    <header id="main-header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon" id="logo-icon">SLA</div>
                    <h1>Sistema de <span>Logística e Armazenamento</span></h1>
                </div>
                <div class="user-info" id="user-info">
                    <span id="">Usuário</span>
                    <span class="user-type" id="user-type-display">Funcionário</span>
                    <a href="login.html" class="btn btn-danger" id="logout-btn" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
                        <i class="fas fa-sign-out-alt"></i>
                        Sair
                    </a>
                </div>
            </div>
        </div>
    </header>

    <section class="page">
        <div class="container">
            <div class="employee-dashboard" id="employee-dashboard">
                <div class="dashboard-header">
                    <div class="welcome-message">
                        <h2 id="welcome-employee">Bem-vindo, Funcionário!</h2>
                        <p>Painel de Controle do Funcionário</p>
                    </div>
                </div>

                <div class="employee-controls">
                    <button class="employee-control-btn active" id="employee-btn-solicitacoes" onclick="switchEmployeeSection('solicitacoes')">
                        <i class="fas fa-file-alt"></i>
                        Solicitações
                    </button>
                    <button class="employee-control-btn" id="employee-btn-movimentacao" onclick="switchEmployeeSection('movimentacao')">
                        <i class="fas fa-exchange-alt"></i>
                        Movimentação
                    </button>
                </div>

                <!--HTML dos cards que puxa em tempo real-->
                <div class="employee-section active" id="employee-section-solicitacoes">
                    <div class="employee-metrics">

                        <!-- Solicitações Pendentes -->
                        <div class="employee-metric-card">
                            <div class="employee-metric-header">
                                <div class="employee-metric-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                            <div class="employee-metric-value" id="metric-pendentes"></div>
                            <div class="employee-metric-label">Solicitações Pendentes</div>
                        </div>

                        <!-- Solicitações Aprovadas -->
                        <div class="employee-metric-card">
                            <div class="employee-metric-header">
                                <div class="employee-metric-icon">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                            <div class="employee-metric-value" id="metric-concluidas"></div>
                            <div class="employee-metric-label">Solicitações Concluídas</div>
                        </div>
                    </div>
                </div>

                <div class="employee-section" id="employee-section-movimentacao">
                    <div class="employee-metrics">
                        <div class="employee-metric-card">
                            <div class="employee-metric-header">
                                <div class="employee-metric-icon">
                                    <i class="fas fa-arrow-down"></i>
                                </div>
                            </div>
                            <div class="employee-metric-value" id="card-entrada-material"></div>
                            <div class="employee-metric-label">Entradas Este Mês</div>
                        </div>
                        <div class="employee-metric-card">
                            <div class="employee-metric-header">
                                <div class="employee-metric-icon">
                                    <i class="fas fa-arrow-up"></i>
                                </div>
                            </div>
                            <div class="employee-metric-value" id="card-saida-material"></div>
                            <div class="employee-metric-label">Saídas Este Mês</div>
                        </div>
                    </div>

                    <div class="card employee-card">
                        <h2 class="card-title employee-title">Movimentação de Materiais</h2>
                        
                        <div class="transaction-type">
                            <button class="btn active" id="employee-deposit-btn">
                                <i class="fas fa-boxes"></i>
                                <span>Entrada de Material</span>
                            </button>
                            <button class="btn btn-secondary" id="employee-withdrawal-btn">
                                <i class="fas fa-dolly"></i>
                                <span>Retirada de Material</span>
                            </button>
                        </div>
                        
                        <form id="employee-transaction-form">
                            <div class="transaction-form">
                                <div class="form-group">
                                    <label for="employee-transaction-material">Nome do Produto</label>
                                    <div class="input-with-icon">
                                        <i class="input-icon fas fa-box"></i>
                                        <input type="text" placeholder="Digite o nome do material" id="employee-transaction-name">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="employee-transaction-quantity">Quantidade</label>
                                    <div class="input-with-icon">
                                        <i class="input-icon fas fa-hashtag"></i>
                                        <input type="number" id="employee-transaction-quantity" min="1" placeholder="Digite a quantidade" required>
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="employee-transaction-location">Localização</label>
                                    <div class="input-with-icon">
                                        <i class="input-icon fas fa-map-marker-alt"></i>
                                        <input type="text" placeholder="Digite seu setor" required id="employee-transaction-location">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="employee-transaction-date">Data</label>
                                    <div class="input-with-icon">
                                        <i class="input-icon fas fa-project-diagram"></i>
                                        <input type="date" placeholder="Digite a data" id="employee-transaction-date" required>
                                    </div>
                                </div>

                                <div class="form-group full-width">
                                    <label for="employee-transaction-notes">Observações</label>
                                    <div class="input-with-icon">
                                        <i class="input-icon fas fa-sticky-note"></i>
                                        <textarea id="employee-transaction-notes" rows="3" placeholder="Adicione observações se necessário"></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <button type="submit" class="btn btn-block btn-success" id="employee-transaction-submit-btn">
                                <i class="fas fa-check-circle"></i>
                                <span>Registrar Entrada</span>
                            </button>
                        </form>
                    </div>
                </div>

                <div class="employee-section" id="employee-section-manutencao">
                    <div class="employee-metrics">
                        <div class="employee-metric-card">
                            <div class="employee-metric-header">
                                <div class="employee-metric-icon">
                                    <i class="fas fa-tools"></i>
                                </div>
                            </div>
                            <div class="employee-metric-value">5</div>
                            <div class="employee-metric-label">Solicitações de Manutenção</div>
                        </div>
                        <div class="employee-metric-card">
                            <div class="employee-metric-header">
                                <div class="employee-metric-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                            </div>
                            <div class="employee-metric-value">2</div>
                            <div class="employee-metric-label">Em Andamento</div>
                        </div>
                        <div class="employee-metric-card">
                            <div class="employee-metric-header">
                                <div class="employee-metric-icon">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                            </div>
                            <div class="employee-metric-value">18</div>
                            <div class="employee-metric-label">Concluídas</div>
                        </div>
                    </div>

                    <div class="maintenance-grid">
                        <div class="maintenance-card">
                            <div class="maintenance-header">
                                <div class="maintenance-icon">
                                    <i class="fas fa-warehouse"></i>
                                </div>
                            </div>
                            <div class="maintenance-value">2</div>
                            <div class="maintenance-label">Equipamentos Críticos</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-high"></div>
                            </div>
                            <div class="employee-quick-actions">
                                <button class="employee-quick-action-btn" onclick="solicitarManutencao('Empilhadeira')">
                                    <i class="fas fa-wrench"></i> Solicitar
                                </button>
                            </div>
                        </div>

                        <div class="maintenance-card">
                            <div class="maintenance-header">
                                <div class="maintenance-icon">
                                    <i class="fas fa-truck"></i>
                                </div>
                            </div>
                            <div class="maintenance-value">3</div>
                            <div class="maintenance-label">Veículos em Manutenção</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-medium"></div>
                            </div>
                            <div class="employee-quick-actions">
                                <button class="employee-quick-action-btn" onclick="solicitarManutencao('Veículos')">
                                    <i class="fas fa-calendar"></i> Agendar
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card employee-card">
                        <h2 class="card-title employee-title">Minhas Solicitações de Manutenção</h2>
                        
                        <table class="advanced-table">
                            <thead>
                                <tr>
                                </tr>
                            </thead>
                            <tbody id="solicatacao-funcionario">
    
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="card employee-card" id="card-minhas-solicitacoes">
                        <h2 class="card-title employee-title">Minhas Solicitações de Manutenção</h2>
                        <table class="advanced-table">

                            <thead>

                                <tr>

                                <th>ID</th>
                                    <th>Item</th>
                                    <th>Resposavel</th>
                                    <th>Data da Solicitação</th>
                                    <th>Setor</th>
                                    <th>Observação</th>
                                    <th>Status</th>
                                </tr>

                            </thead>

                            <tbody id="solicatacao-funcionario">
                            </tbody>

                        </table>

                    </div>



                    <div class="card employee-card" id="card-nova-solicitacao">


                        <h2 class="card-title employee-title">Nova Solicitação de Manutenção</h2>

                       

                        <form id="employee-maintenance-form">

                            <div class="transaction-form">

                                <div class="form-group">

                                    <label for="employee-maintenance-equipment">Equipamento</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-toolbox"></i>

                                        <select id="employee-maintenance-equipment" required>

                                            <option value="">Selecione o equipamento</option>

                                            <option value="empilhadeira">Empilhadeira Elétrica</option>

                                            <option value="esteira">Esteira Transportadora</option>

                                            <option value="refrigeracao">Sistema de Refrigeração</option>

                                            <option value="computador">Computador</option>

                                        </select>

                                    </div>

                                </div>

                               

                                <div class="form-group">

                                    <label for="employee-maintenance-type">Tipo de Manutenção</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-wrench"></i>

                                        <select id="employee-maintenance-type" required>

                                            <option value="preventiva">Preventiva</option>

                                            <option value="corretiva">Corretiva</option>

                                        </select>

                                    </div>

                                </div>

                               

                                <div class="form-group">

                                    <label for="employee-maintenance-priority">Prioridade</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-flag"></i>

                                        <select id="employee-maintenance-priority" required>

                                            <option value="baixa">Baixa</option>

                                            <option value="media">Média</option>

                                            <option value="alta">Alta</option>

                                        </select>

                                    </div>

                                </div>

                               

                                <div class="form-group full-width">

                                    <label for="employee-maintenance-description">Descrição do Problema</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-sticky-note"></i>

                                        <textarea id="employee-maintenance-description" rows="3" placeholder="Descreva o problema ou serviço necessário" required></textarea>

                                    </div>

                                </div>

                            </div>

                           

                            <button type="submit" class="btn btn-block btn-warning">

                                <i class="fas fa-tools"></i>

                                <span>Solicitar Manutenção</span>

                            </button>

                        </form>

                    </div>

                </div>



                <!-- Seção de Nova Solicitação -->

                <div class="employee-section" id="employee-section-nova-solicitacao">

                    <div class="card employee-card">

                        <h2 class="card-title employee-title">Nova Solicitação de Material</h2>

                       

                        <form id="employee-request-form">

                            <div class="transaction-form">

                                <div class="form-group">

                                    <label for="employee-material">Material Solicitado</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-box"></i>

                                        <select id="employee-material" required>

                                            <option value="">Selecione um material</option>

                                            <option value="ferramentas">Ferramentas</option>

                                            <option value="eletronicos">Componentes Eletrônicos</option>

                                            <option value="materiais-escritorio">Materiais de Escritório</option>

                                            <option value="epi">Equipamentos de Proteção</option>

                                        </select>

                                    </div>

                                </div>

                               

                                <div class="form-group">

                                    <label for="employee-quantity">Quantidade</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-hashtag"></i>

                                        <input type="number" id="employee-quantity" min="1" placeholder="Digite a quantidade" required>

                                    </div>

                                </div>

                               

                                <div class="form-group">

                                    <label for="employee-project">Projeto/Atividade</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-project-diagram"></i>

                                        <input type="text" id="employee-project" placeholder="Nome do projeto ou atividade" required>

                                    </div>

                                </div>

                               

                                <div class="form-group">

                                    <label for="employee-urgency">Urgência</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-exclamation-triangle"></i>

                                        <select id="employee-urgency" required>

                                            <option value="baixa">Baixa</option>

                                            <option value="media">Média</option>

                                            <option value="alta">Alta</option>

                                        </select>

                                    </div>

                                </div>



                                <div class="form-group full-width">

                                    <label for="employee-justification">Justificativa</label>

                                    <div class="input-with-icon">

                                        <i class="input-icon fas fa-sticky-note"></i>

                                        <textarea id="employee-justification" rows="3" placeholder="Explique a necessidade deste material" required></textarea>

                                    </div>

                                </div>

                            </div>

                           

                            <button type="submit" class="btn btn-block btn-success">

                                <i class="fas fa-paper-plane"></i>

                                <span>Enviar Solicitação</span>

                            </button>

                        </form>

                    </div>

                </div>

            </div>



            <!-- Interface Básica do Funcionário (Fallback) -->

            <div class="employee-interface" id="employee-interface">

                <div class="card">

                    <h2 class="card-title">Interface do Funcionário</h2>

                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 2rem;">

                        Esta é a interface do funcionário. Faça login como gerente para acessar o dashboard administrativo.

                    </p>

                    <div style="text-align: center;">

                        <button class="btn btn-success" onclick="location.reload()">

                            <i class="fas fa-sync-alt"></i>

                            Recarregar Página

                        </button>

                    </div>

                </div>

            </div>

        </div>

    </section>



    <script src="../../Back-End/back/deposit.js"></script>

    <script>
    // Função para inicializar os botões de entrada/retirada
    function initializeTransactionButtons() {
        const depositBtn = document.getElementById('employee-deposit-btn');
        const withdrawalBtn = document.getElementById('employee-withdrawal-btn');
        const submitBtn = document.getElementById('employee-transaction-submit-btn');
        
        if (!depositBtn || !withdrawalBtn || !submitBtn) {
            console.error('Botões de transação não encontrados');
            return;
        }
        
        // Configurar botão de retirada
        withdrawalBtn.addEventListener('click', function() {
            // Alternar classes ativas
            depositBtn.classList.remove('active');
            withdrawalBtn.classList.remove('btn-secondary');
            withdrawalBtn.classList.add('active');
            depositBtn.classList.add('btn-secondary');
            
            // Mudar texto do botão de envio
            const submitBtnText = submitBtn.querySelector('span');
            if (submitBtnText) {
                submitBtnText.textContent = 'Registrar Retirada';
            }
            
            // Mudar ícone
            const submitBtnIcon = submitBtn.querySelector('i');
            if (submitBtnIcon) {
                submitBtnIcon.className = 'fas fa-minus-circle';
            }
            
            // Mudar cor do botão
            submitBtn.classList.remove('btn-success');
            submitBtn.classList.add('btn-warning');
        });
        
        // Configurar botão de entrada
        depositBtn.addEventListener('click', function() {
            // Alternar classes ativas
            withdrawalBtn.classList.remove('active');
            depositBtn.classList.remove('btn-secondary');
            depositBtn.classList.add('active');
            withdrawalBtn.classList.add('btn-secondary');
            
            // Mudar texto do botão de envio
            const submitBtnText = submitBtn.querySelector('span');
            if (submitBtnText) {
                submitBtnText.textContent = 'Registrar Entrada';
            }
            
            // Mudar ícone
            const submitBtnIcon = submitBtn.querySelector('i');
            if (submitBtnIcon) {
                submitBtnIcon.className = 'fas fa-plus-circle';
            }
            
            // Mudar cor do botão
            submitBtn.classList.remove('btn-warning');
            submitBtn.classList.add('btn-success');
        });
        
        console.log('Botões de transação inicializados');
    }
    
    // Sobrescrever a função switchEmployeeSection para inicializar os botões quando entrar na seção de movimentação
    const originalSwitchEmployeeSection = window.switchEmployeeSection;
    
    window.switchEmployeeSection = function(sectionId) {
        // Chamar a função original se existir
        if (typeof originalSwitchEmployeeSection === 'function') {
            originalSwitchEmployeeSection(sectionId);
        } else {
            // Remover classe active de todos os botões
            document.querySelectorAll('.employee-control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Remover classe active de todas as seções
            document.querySelectorAll('.employee-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Adicionar classe active ao botão clicado
            const btn = document.getElementById(`employee-btn-${sectionId}`);
            if (btn) btn.classList.add('active');
            
            // Adicionar classe active à seção correspondente
            const section = document.getElementById(`employee-section-${sectionId}`);
            if (section) section.classList.add('active');
        }
        
        // Se for a seção de movimentação, inicializar os botões
        if (sectionId === 'movimentacao') {
            setTimeout(initializeTransactionButtons, 100);
        }
    }
    
    // Inicializar quando a página carregar
    document.addEventListener('DOMContentLoaded', function() {
        // Verificar se já estamos na seção de movimentação
        const movimentacaoSection = document.getElementById('employee-section-movimentacao');
        if (movimentacaoSection && movimentacaoSection.classList.contains('active')) {
            initializeTransactionButtons();
        }
    });
</script>

</body>

</html>